webpackJsonp([43],{269:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(505),i=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,function(){return o[t]})}(r);var d=a(906),s=a.n(d),n=a(3),l=n(i.a,s.a,!1,null,null,null);l.options.__file="src/views/news-system/categories/list.vue",e.default=l.exports},505:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(26),i=function(t){return t&&t.__esModule?t:{default:t}}(o);e.default={data:function(){var t=this;return{modalCoverImage:{show:!1,url:null},loading:!1,search:{name:null},addEditCategoryModal:{show:!1,saveLoading:!1},uploadConfig:{headers:{Authorization:localStorage.access_token_type+" "+localStorage.access_token},format:["jpg","jpeg","png","gif"],max_size:500,uploadUrl:window.uploadUrl.uploadOther,data:{max_width:800}},ruleAddEditCategory:{name:[{required:!0,message:"请填写名称",trigger:"blur"}]},addEditCategoryForm:{id:0,name:"",description:"",cover_image:{attachment_id:0,url:""}},dataList:[],columns:[{title:"ID",key:"id",sortable:!0,width:100},{title:"名称",key:"name"},{title:"封面",key:"",render:function(e,a){var o=t;if(a.row.cover_image.url)return e("div",[e("img",{attrs:{src:a.row.cover_image.url},style:{width:"40px",height:"40px"},on:{click:function(t){o.modalCoverImage.show=!0,o.modalCoverImage.url=a.row.cover_image.url}}})])}},{title:"描述",key:"description"},{title:"创建时间",key:"created_at",sortable:!0},{title:"更新时间",key:"created_at"},{title:"操作",render:function(e,a){var o=t;return e("div",[e("Button",{props:{type:"success",size:"small"},on:{click:function(){o.addEditCategoryForm=o.dataList[a.index],o.addEditCategoryModal.show=!0}}},"Edit"),e("Poptip",{props:{confirm:!0,title:"您确定要删除「"+a.row.name+"」？",transfer:!0},on:{"on-ok":function(){o.deleteBtn(a.row.id,a.index)}}},[e("Button",{style:{margin:"0 5px"},props:{type:"error",size:"small",placement:"top"}},"删除")])])}}]}},created:function(){this.getList()},methods:{cleanModal:function(){this.addEditCategoryForm={id:0,name:"",description:"",cover_image:{attachment_id:0,url:""}}},handleSubmit:function(){var t=this;t.$refs.addEditCategoryForm.validate(function(e){e&&(t.addEditCategoryModal.saveLoading=!0,t.$util.ajax.post("/admin/categories",t.addEditCategoryForm).then(function(e){var a=e.data;t.$Notice.success({title:a.message}),t.getList(),t.addEditCategoryModal.saveLoading=!1,t.addEditCategoryModal.show=!1},function(e){t.$Notice.warning({title:"出错了",desc:e.message}),t.addEditCategoryModal.saveLoading=!1}))})},cancelEditPass:function(){var t=this;t.addEditCategoryModal.show=!1,t.addEditCategoryModal.saveLoading=!1,t.cleanModal()},addBtn:function(){this.cleanModal(),this.addEditCategoryModal.show=!0},getList:function(){var t=this;t.loading=!0,t.$util.ajax.get("/admin/categories?search_data="+(0,i.default)(t.search)).then(function(e){var a=e.data;t.dataList=a.data,t.loading=!1},function(e){t.$Notice.warning({title:"出错了",desc:e.message}),t.loading=!1})},deleteBtn:function(t,e){var a=this;a.$util.ajax.delete("/admin/categories/"+t).then(function(t){var o=t.data;a.dataList.splice(e,1),a.$Notice.success({title:o.message})},function(t){a.$Notice.warning({title:"出错了",desc:t.message})})},handleSuccess:function(t,e){var a=t.data;e.url=a.url,e.name=a.original_name,this.addEditCategoryForm.cover_image.attachment_id=a.attachment_id,this.addEditCategoryForm.cover_image.url=a.url},handleFormatError:function(t){this.$Notice.warning({title:"文件格式不正确",desc:"文件 "+t.name+" 格式不正确，请上传 jpg 或 png 格式的图片。"})},handleMaxSize:function(t){this.$Notice.warning({title:"超出文件大小限制",desc:"文件 "+t.name+" 太大，不能超过 "+this.uploadConfig.max_size+"kb"})}}}},906:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"privileges-users-list"}},[a("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"end",gutter:16}},[a("Col",{attrs:{span:"3"}},[a("Input",{attrs:{icon:"search",placeholder:"请输入名称..."},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}})],1),t._v(" "),a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(e){t.getList()}}},[t._v("Search")])],1),t._v(" "),a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"success",icon:"plus"},on:{click:function(e){t.addBtn()}}},[t._v("Add")])],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Table",{attrs:{border:"",columns:t.columns,data:t.dataList,loading:t.loading}})],1),t._v(" "),a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:800},model:{value:t.addEditCategoryModal.show,callback:function(e){t.$set(t.addEditCategoryModal,"show",e)},expression:"addEditCategoryModal.show"}},[a("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[t._v("编辑")]),t._v(" "),a("Form",{ref:"addEditCategoryForm",attrs:{model:t.addEditCategoryForm,"label-width":100,"label-position":"right",rules:t.ruleAddEditCategory}},[a("FormItem",{attrs:{label:"名称",prop:"name"}},[a("Input",{attrs:{placeholder:"请输入名称"},model:{value:t.addEditCategoryForm.name,callback:function(e){t.$set(t.addEditCategoryForm,"name",e)},expression:"addEditCategoryForm.name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"封面："}},[a("div",{staticStyle:{display:"inline-block",width:"50%"}},[a("Upload",{staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"on-success":t.handleSuccess,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,headers:t.uploadConfig.headers,"max-size":t.uploadConfig.max_size,format:t.uploadConfig.format,data:t.uploadConfig.data,name:"other",type:"drag",action:t.uploadConfig.uploadUrl}},[a("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[a("Icon",{attrs:{type:"camera",size:"20"}})],1)]),t._v(" "),t.addEditCategoryForm.cover_image.url?a("img",{staticClass:"normall-image",attrs:{src:t.addEditCategoryForm.cover_image.url,alt:""}}):t._e()],1)]),t._v(" "),a("FormItem",{attrs:{label:"描述",prop:"description"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入描述"},model:{value:t.addEditCategoryForm.description,callback:function(e){t.$set(t.addEditCategoryForm,"description",e)},expression:"addEditCategoryForm.description"}})],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.cancelEditPass}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",loading:t.addEditCategoryModal.saveLoading},on:{click:t.handleSubmit}},[t._v("保存")])],1)],1),t._v(" "),a("Modal",{model:{value:t.modalCoverImage.show,callback:function(e){t.$set(t.modalCoverImage,"show",e)},expression:"modalCoverImage.show"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("图片预览")]),t._v(" "),a("div",{staticClass:"text-center"},[t.modalCoverImage.show?a("img",{staticClass:"center-align",attrs:{src:t.modalCoverImage.url,alt:""}}):t._e()]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})])],1)},i=[];o._withStripped=!0;var r={render:o,staticRenderFns:i};e.default=r}});
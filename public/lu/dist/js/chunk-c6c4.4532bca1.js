(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c6c4"],{2934:function(e,t,a){"use strict";a.d(t,"b",function(){return o}),a.d(t,"c",function(){return s}),a.d(t,"a",function(){return r});var n=a("66df"),o=function(e){return n["a"].request({url:"/api/common_get_table_status/"+e,method:"get"})},s=function(e,t,a){return n["a"].request({url:"/api/common_switch_enable",data:{id:e,table:t,value:a},method:"post"})},r=function(e){return n["a"].request({url:"/api/admin/attachments/"+e+"/force_destroy",method:"delete"})}},fd1c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"end",gutter:16}},[a("Col",{attrs:{span:"3"}},[a("Input",{attrs:{icon:"search",placeholder:"请输入昵称..."},model:{value:e.searchForm.user_name,callback:function(t){e.$set(e.searchForm,"user_name",t)},expression:"searchForm.user_name"}})],1),a("Col",{attrs:{span:"2"}},[a("Select",{attrs:{placeholder:"日志类型"},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},[a("Option",{key:"",attrs:{value:""}},[e._v("全部类型")]),e._l(e.tableStatus.type,function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})],2)],1),a("Col",{attrs:{span:"3"}},[a("Select",{attrs:{placeholder:"表",filterable:""},model:{value:e.searchForm.table_name,callback:function(t){e.$set(e.searchForm,"table_name",t)},expression:"searchForm.table_name"}},[a("Option",{key:"",attrs:{value:""}},[e._v("全部表")]),e._l(e.tableStatus.table_name,function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t)+" ")])})],2)],1),a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){e.getTableDataExcute(e.feeds.current_page)}}},[e._v("Search")])],1)],1),a("br"),a("Row",[e.tableLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[e._v("加载中...")])],1)],1):e._e(),a("Table",{attrs:{border:"",columns:e.columns,data:e.feeds.data},on:{"on-sort-change":e.onSortChange}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"paging",attrs:{total:e.feeds.total,current:e.feeds.current_page,"page-size":e.feeds.per_page,"show-elevator":"","show-total":"","show-sizer":""},on:{"on-change":e.handleOnPageChange,"on-page-size-change":e.onPageSizeChange}})],1)])],1),!0===e.showInfoModal.show?a("show-info",{attrs:{info:e.showInfoModal.info},on:{"show-modal-close":e.showModalClose}}):e._e()],1)},o=[],s=(a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Drawer",{attrs:{closable:!1,width:"640",title:"用户信息："},on:{"on-close":e.closed},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("p",{staticClass:"drawer-title"},[e._v("日志内容：")]),a("transition",{attrs:{name:"publish-time"}},[a("div",{staticClass:"publish-time-picker-con"},e._l(e.info.content,function(t,n){return a("div",{staticClass:"margin-top-10"},[e._v(" "+e._s(n)+":   \n          "),a("span",{staticClass:"green-color"},[e._v(e._s(t))])])}))])],1)],1)}),r=[],i={props:{info:{type:Object,default:""}},data:function(){return{show:!0}},methods:{closed:function(){this.show=!1,this.$emit("show-modal-close")}}},l=i,c=a("66b7"),u=Object(c["a"])(l,s,r,!1,null,null,null);u.options.__file="show-info.vue";var d=u.exports,h=a("2934"),f=a("66df"),p=function(e,t,a){return f["a"].request({url:"/api/admin/logs",params:{page:e,per_page:t,search_data:JSON.stringify(a)},method:"get"})},m={components:{ShowInfo:d},data:function(){var e=this;return{searchForm:{order_by:"id,desc"},tableLoading:!1,tableStatus:{type:[],table_name:[]},feeds:{data:[],total:0,current_page:1,per_page:10},showInfoModal:{show:!1,info:""},columns:[{title:"ID",key:"id",sortable:"customer",width:100},{title:"操作人",key:"id",render:function(e,t){return e("div",{class:"green-color"},t.row.user.name+"--"+t.row.user.email)}},{title:"类型",render:function(t,a){return t("div",e.tableStatus.type[a.row.type])}},{title:"表",render:function(t,a){return t("div",e.tableStatus.table_name[a.row.table_name])}},{title:"IP",key:"ip",width:150},{title:"创建时间",sortable:!0,key:"created_at"},{title:"操作",key:"",width:250,render:function(t,a){var n=e;return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){n.showInfoModal.show=!0,n.showInfoModal.info=a.row}}},"详细")])}}]}},mounted:function(){var e=this;e.getTableStatusExcute("logs"),e.getTableDataExcute(e.feeds.current_page)},methods:{handleOnPageChange:function(e){this.getTableDataExcute(e)},onPageSizeChange:function(e){this.feeds.per_page=e,this.getTableDataExcute(this.feeds.current_page)},getTableStatusExcute:function(e){var t=this;Object(h["b"])(e).then(function(e){var a=e.data;t.tableStatus.type=a.type,t.tableStatus.table_name=a.table_name})},getTableDataExcute:function(e){var t=this;t.tableLoading=!0,t.feeds.current_page=e,p(e,t.feeds.per_page,t.searchForm).then(function(e){t.feeds.data=e.data,t.feeds.total=e.meta.total,t.tableLoading=!1},function(e){t.tableLoading=!1})},onSortChange:function(e){var t=e.column.key+","+e.order;this.searchForm.order_by=t,this.getTableDataExcute(this.feeds.current_page)},showModalClose:function(){this.showInfoModal.show=!1}}},_=m,g=Object(c["a"])(_,n,o,!1,null,null,null);g.options.__file="list.vue";t["default"]=g.exports}}]);
webpackJsonp([17],{268:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(503),s=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);var r=a(905),o=a.n(r),l=a(3),d=l(s.a,o.a,!1,null,null,null);d.options.__file="src/views/news-system/advertisements/list.vue",t.default=d.exports},503:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(26),i=n(s),r=a(903),o=n(r);t.default={components:{expandRow:o.default},data:function(){var e=this;return{modalHeadImage:{show:!1,url:null},loading:!1,search:{},advertisement_positions_ids:{},tableStatus:{enable:[]},feeds:{data:[],total:0,current_page:1,per_page:10},columns:[{title:">>",type:"expand",width:50,render:function(e,t){return e(o.default,{props:{row:t.row}})}},{title:"ID",key:"id",sortable:!0,width:100},{title:"广告标题",key:"name"},{title:"封面",width:200,render:function(t,a){var n=e;return t("div",[t("img",{attrs:{src:a.row.cover_image.url},style:{width:"40px",height:"40px"},on:{click:function(e){n.modalHeadImage.show=!0,n.modalHeadImage.url=a.row.cover_image.url}}})])}},{title:"广告位",width:150,render:function(e,t){return e("div",t.row.advertisement_position.name)}},{title:"启用状态",key:"enable",render:function(t,a){return t("i-switch",{props:{slot:"open",type:"primary",value:"T"===a.row.enable},on:{"on-change":function(t){e.switchEnable(a.index)}}})}},{title:"有效期",width:350,render:function(e,t){var a=t.row,n="green",s=a.start_at?a.start_at:"永久有效";return s+=a.end_at?"--"+a.end_at:"",a.overdue_time<86400&&a.overdue_time>0?n="yellow":a.overdue_time<0&&(n="red"),e("div",[e("Tag",{props:{type:"dot",color:n}},s)])}},{title:"创建时间",key:"created_at"},{title:"操作",render:function(t,a){var n=e;return t("div",[t("Button",{props:{type:"success",size:"small"},on:{click:function(){e.$router.push({name:"edit-advertisement",params:{advertisement_id:a.row.id}})}}},"Edit"),t("Poptip",{props:{confirm:!0,title:"您确定要删除「"+a.row.name+"」广告？",transfer:!0},on:{"on-ok":function(){n.deleteBtn(a.row.id,a.index)}}},[t("Button",{style:{margin:"0 5px"},props:{type:"error",size:"small",placement:"top"}},"删除")])])}}]}},created:function(){var e=this;e.getList(e.feeds.current_page),e.getTableStatus(),e.getAdvertisementPositions()},methods:{getTableStatus:function(){var e=this;e.$util.ajax.get("/common_get_table_status/advertisements/enable").then(function(t){var a=t.data;e.tableStatus.enable=a.data},function(e){})},getAdvertisementPositions:function(){var e=this;e.$util.ajax.get("/admin/advertisement_positions/all").then(function(t){var a=t.data;e.advertisement_positions_ids=a.data},function(e){})},handleOnPageChange:function(e){this.getList(e)},getList:function(e){var t=this;t.loading=!0,t.feeds.current_page=e,t.$util.ajax.get("/admin/advertisements?page="+e+"&per_page="+t.feeds.per_page+"&search_data="+(0,i.default)(t.search)).then(function(e){var a=e.data;t.feeds.data=a.data,t.feeds.total=a.meta.total,t.loading=!1},function(e){t.$Notice.warning({title:"出错了",desc:e.message}),t.loading=!1})},addBtn:function(){this.$router.push({name:"add-advertisement"})},deleteBtn:function(e,t){var a=this;a.$util.ajax.delete("/admin/advertisements/"+e).then(function(e){var n=e.data;a.feeds.data.splice(t,1),a.$Notice.success({title:n.message})},function(e){a.$Notice.warning({title:"出错了",desc:e.message})})},switchEnable:function(e){var t=this,a="T";"T"===t.feeds.data[e].enable&&(a="F"),t.$util.ajax.post("/common_switch_enable",{table:"advertisements",id:t.feeds.data[e].id,value:a}).then(function(n){t.feeds.data[e].enable=a;var s=n.data;t.$Notice.success({title:s.message})},function(e){t.$Notice.warning({title:"出错了",desc:e.message})})}}}},504:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{row:Object}}},903:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(504),s=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);var r=a(904),o=a.n(r),l=a(3),d=l(s.a,o.a,!1,null,null,null);d.options.__file="src/views/news-system/advertisements/list-table-expand.vue",t.default=d.exports},904:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Col",{attrs:{span:"8"}},[a("Card",[a("Row",{staticClass:"expand-row"},[a("span",{staticClass:"expand-key expand-title"},[e._v("跳转链接:    ")]),e._v(" "),a("a",{attrs:{href:e.row.link_url,target:"_blank"}},[e._v(e._s(e.row.link_url))])]),e._v(" "),a("Row",{staticClass:"expand-row"},[a("p",{staticClass:"margin-top-10"},[a("b",[e._v("键值对：")]),e._v(" "),a("transition",{attrs:{name:"publish-time"}},[a("div",{staticClass:"publish-time-picker-con"},[a("div",{staticClass:"margin-top-10"},[e._v(" 模型：   \n                                "),e.row.model_column_value.model?a("span",{staticClass:"green-color"},[e._v(e._s(e.row.model_column_value.model))]):a("span",[e._v(" -- ")])]),e._v(" "),a("div",{staticClass:"margin-top-10"},[e._v(" 字段：   \n                                "),e.row.model_column_value.column?a("span",{staticClass:"green-color"},[e._v(e._s(e.row.model_column_value.column))]):a("span",[e._v(" -- ")])]),e._v(" "),a("div",{staticClass:"margin-top-10"},[e._v(" 字段值：\n                                "),e.row.model_column_value.value?a("span",{staticClass:"green-color"},[e._v(e._s(e.row.model_column_value.value))]):a("span",[e._v(" -- ")])])])])],1)])],1)],1)],1)},s=[];n._withStripped=!0;var i={render:n,staticRenderFns:s};t.default=i},905:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"news_system-advertisement_positions-list"}},[a("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"end",gutter:16}},[a("Col",{attrs:{span:"3"}},[a("Input",{attrs:{icon:"search",placeholder:"请输入广告标题..."},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),e._v(" "),a("Col",{attrs:{span:"2"}},[a("Select",{attrs:{placeholder:"是否启用"},model:{value:e.search.enable,callback:function(t){e.$set(e.search,"enable",t)},expression:"search.enable"}},[a("Option",{key:"",attrs:{value:""}},[e._v("全部")]),e._v(" "),e._l(e.tableStatus.enable,function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})],2)],1),e._v(" "),a("Col",{attrs:{span:"3"}},[a("Select",{attrs:{filterable:"",placeholder:"请选择广告位类型"},model:{value:e.search.advertisement_positions_id,callback:function(t){e.$set(e.search,"advertisement_positions_id",t)},expression:"search.advertisement_positions_id"}},[a("Option",{key:"",attrs:{value:""}},[e._v("全部")]),e._v(" "),e._l(e.advertisement_positions_ids,function(t,n){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name)+"\n                ")])})],2)],1),e._v(" "),a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){e.getList(1)}}},[e._v("Search")])],1),e._v(" "),a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"success",icon:"plus"},on:{click:function(t){e.addBtn()}}},[e._v("Add")])],1)],1),e._v(" "),a("br"),e._v(" "),a("Row",[a("Table",{attrs:{border:"",columns:e.columns,data:e.feeds.data,loading:e.loading}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"paging",attrs:{total:e.feeds.total,current:e.feeds.current_page,"page-size":e.feeds.per_page,"show-elevator":"","show-total":""},on:{"on-change":e.handleOnPageChange}})],1)])],1),e._v(" "),a("Modal",{attrs:{width:"1000px"},model:{value:e.modalHeadImage.show,callback:function(t){e.$set(e.modalHeadImage,"show",t)},expression:"modalHeadImage.show"}},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v("图片预览")]),e._v(" "),a("div",{staticClass:"text-center"},[e.modalHeadImage.show?a("img",{staticClass:"center-align",attrs:{src:e.modalHeadImage.url,alt:""}}):e._e()]),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})])],1)},s=[];n._withStripped=!0;var i={render:n,staticRenderFns:s};t.default=i}});